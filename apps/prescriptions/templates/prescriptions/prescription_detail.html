{% extends 'base.html' %}
{% load static %}

{% block title %}Ø¬Ø²Ø¦ÛŒØ§Øª Ù†Ø³Ø®Ù‡{% endblock %}

{% block content %}
<style>
    /* ğŸ”’ Security: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ú©Ù¾ÛŒ Ùˆ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ØªÙ† */
    * {
        user-select: none !important;
        -webkit-user-select: none !important;
        -moz-user-select: none !important;
        -ms-user-select: none !important;
        -webkit-touch-callout: none !important;
    }

    img,
    a,
    button {
        -webkit-user-drag: none !important;
        user-drag: none !important;
    }

    ::selection {
        background: transparent !important;
        color: inherit !important;
    }

    ::-moz-selection {
        background: transparent !important;
        color: inherit !important;
    }

    /* Watermark */
    .watermark {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        opacity: 0.2;
        font-size: 4rem;
        font-weight: 900;
        color: #000;
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: center;
        gap: 6rem;
        transform: rotate(-35deg);
        text-shadow: #000 0.5rem 0.5rem  1.5rem;
        border-top: solid black 1px;
        border-bottom: solid black 1px;
    
    }

    .watermark::before,
    .watermark::after {
        content: attr(data-text);
    }

    /* Header Container */
    .prescription-header {
        background: white;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        border-bottom: 4px solid #e5e7eb;
    }

    /* Category Badge - ÙÙ‚Ø· background Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© */
    .category-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.625rem 1.25rem;
        border-radius: 9999px;
        font-weight: 700;
        font-size: 0.9375rem;
        color: white !important;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        transition: all 0.3s ease;
    }

    .category-badge:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
    }

    /* Access Badge */
    .badge-premium {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 9999px;
        font-weight: 700;
        font-size: 0.875rem;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
    }

    .badge-free {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 9999px;
        font-weight: 700;
        font-size: 0.875rem;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    }

    /* Action Buttons */
    .btn-action {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border-radius: 12px;
        font-weight: 600;
        font-size: 0.9375rem;
        transition: all 0.3s ease;
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .btn-action:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
    }

    .btn-save {
        background: white;
        color: #374151;
        border: 2px solid #e5e7eb;
    }

    .btn-save:hover {
        border-color: #10b981;
        color: #10b981;
    }

    .btn-save.saved {
        background: #10b981;
        color: white;
        border-color: #10b981;
    }

    .btn-share,
    .btn-question {
        background: white;
        color: #6b7280;
        border: 2px solid #e5e7eb;
    }

    .btn-share:hover,
    .btn-question:hover {
        border-color: #10b981;
        color: #10b981;
    }

    /* Alternative Names */
    .alt-name {
        display: inline-block;
        padding: 0.4rem 0.875rem;
        background: #f3f4f6;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 600;
        color: #6b7280;
        transition: all 0.2s ease;
    }

    .alt-name:hover {
        background: #e5e7eb;
        transform: translateY(-1px);
    }

    /* Primary Name Badge */
    .primary-name-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.625rem 1.25rem;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1.125rem;
        color: white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    /* Back Button */
    .btn-back {
        display: inline-flex;
        align-items: center;
        gap: 0.625rem;
        padding: 0.75rem 1.25rem;
        background: white;
        border: 2px solid #e5e7eb;
        border-radius: 10px;
        font-weight: 600;
        color: #374151;
        text-decoration: none;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .btn-back:hover {
        transform: translateX(6px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        border-color: #9ca3af;
        color: #111827;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .prescription-header {
            border-bottom-width: 3px;
        }

        .btn-action {
            width: 100%;
            justify-content: center;
        }
    }

    /* Warning Box */
    .warning-box {
        background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        border-right: 6px solid #dc2626;
        box-shadow: 0 8px 32px rgba(220, 38, 38, 0.15);
        animation: warningPulse 3s ease-in-out infinite;
    }

    @keyframes warningPulse {

        0%,
        100% {
            box-shadow: 0 8px 32px rgba(220, 38, 38, 0.15);
        }

        50% {
            box-shadow: 0 12px 40px rgba(220, 38, 38, 0.25);
        }
    }

    .warning-icon {
        background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        box-shadow: 0 4px 16px rgba(220, 38, 38, 0.3);
        animation: iconBounce 2s ease-in-out infinite;
    }

    @keyframes iconBounce {

        0%,
        100% {
            transform: translateY(0);
        }

        50% {
            transform: translateY(-4px);
        }
    }

    /* Responsive */
    @media (max-width: 768px) {
        .prescription-header {
            border-bottom-width: 3px;
        }

        .btn-action {
            width: 100%;
            justify-content: center;
        }
    }

    /* Warning Box */
    .warning-box {
        background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
        border-right: 6px solid #dc2626;
        box-shadow: 0 8px 32px rgba(220, 38, 38, 0.15);
        animation: warningPulse 3s ease-in-out infinite;
    }

    @keyframes warningPulse {

        0%,
        100% {
            box-shadow: 0 8px 32px rgba(220, 38, 38, 0.15);
        }

        50% {
            box-shadow: 0 12px 40px rgba(220, 38, 38, 0.25);
        }
    }

    .warning-icon {
        background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
        box-shadow: 0 4px 16px rgba(220, 38, 38, 0.3);
        animation: iconBounce 2s ease-in-out infinite;
    }

    @keyframes iconBounce {

        0%,
        100% {
            transform: translateY(0);
        }

        50% {
            transform: translateY(-4px);
        }
    }
     /* GLightbox Custom Styles */
     .glightbox-clean .gslide-description {
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(10px);
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: 'Vazirmatn', sans-serif;
            text-align: center;
        }
    
        .glightbox-clean .gslide-title {
            font-weight: bold;
            font-size: 0.875rem;
            color: white;
            margin: 0;
        }
    
        .glightbox-clean .gprev,
        .glightbox-clean .gnext {
            background: rgba(0, 119, 182, 0.9);
            backdrop-filter: blur(10px);
        }
    
        .glightbox-clean .gprev:hover,
        .glightbox-clean .gnext:hover {
            background: rgba(0, 180, 216, 0.9);
        }
</style>

<div x-data="prescriptionDetailApp()" x-init="init()" class="min-h-screen pt-16 bg-gray-50">

    <!-- ğŸ” Watermark -->
    <div class="watermark" :data-text="watermarkText"></div>

    <!-- â³ Loading State -->
    <div x-show="loading" class="max-w-7xl mx-auto px-4 py-12">
        <div class="bg-white rounded-3xl shadow-2xl p-16 text-center">
            <i class="fas fa-spinner fa-spin text-6xl text-blue-500 mb-6"></i>
            <p class="text-2xl font-bold text-gray-700">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</p>
        </div>
    </div>

    <!-- ğŸ¯ MAIN HEADER -->
    <div x-show="!loading" x-cloak>

        <!-- Header -->
        <div class="prescription-header">

            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

                <!-- Ø±Ø¯ÛŒÙ Ø§ÙˆÙ„: Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª + Ø¨Ø¬â€ŒÙ‡Ø§ -->
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6">

                    <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª -->
                    <a href="/prescriptions" class="btn-back">
                        <i class="fas fa-arrow-right"></i>
                        <span>Ø¨Ø§Ø²Ú¯Ø´Øª</span>
                    </a>

                    <!-- Ø¨Ø¬â€ŒÙ‡Ø§ -->
                    <div class="flex flex-wrap items-center gap-3">

                        <!-- Ø¨Ø¬ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ - ÙÙ‚Ø· background Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© -->
                        <span class="category-badge" :class="prescription?.category?.color_code">
                            <i class="fas fa-folder"></i>
                            <span x-text="prescription?.category?.title"></span>
                        </span>

                        <!-- Ø¨Ø¬ ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø§Ø±ÙˆÙ‡Ø§ -->
                        <span
                            class="inline-flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-full font-bold text-gray-700 text-sm">
                            <i class="fas fa-pills"></i>
                            <span x-text="prescription?.prescription_drugs?.length + ' Ø¯Ø§Ø±Ùˆ'"></span>
                        </span>

                        <!-- Ø¨Ø¬ Ø³Ø·Ø­ Ø¯Ø³ØªØ±Ø³ÛŒ -->
                        <span :class="prescription?.access_level === 'PREMIUM' ? 'badge-premium' : 'badge-free'">
                            <i :class="prescription?.access_level === 'PREMIUM' ? 'fas fa-crown' : 'fas fa-unlock'"></i>
                            <span x-text="prescription?.access_level === 'PREMIUM' ? 'ÙˆÛŒÚ˜Ù‡' : 'Ø±Ø§ÛŒÚ¯Ø§Ù†'"></span>
                        </span>

                    </div>
                </div>

                <!-- Ø±Ø¯ÛŒÙ Ø¯ÙˆÙ…: Ø¹Ù†ÙˆØ§Ù† + Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† -->
                <div class="mb-6">
                    <!-- Ø¹Ù†ÙˆØ§Ù† Ø§ØµÙ„ÛŒ -->
                    <h1 class="text-4xl sm:text-5xl font-black text-gray-900 mb-3" x-text="prescription?.title"></h1>

                    <!-- Ù†Ø§Ù… Ø§ØµÙ„ÛŒ (Primary Name) - ÙÙ‚Ø· background Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© -->
                    <div class="mb-4">
                        <span class="primary-name-badge" :class="prescription?.category?.color_code">
                            <i class="fas fa-tag"></i>
                            <span x-text="prescription?.primary_name"></span>
                        </span>
                    </div>

                
                </div>

                <!-- Ø±Ø¯ÛŒÙ Ø³ÙˆÙ…: Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª -->
                <div class="flex flex-wrap gap-3">

                    <!-- Ø¯Ú©Ù…Ù‡ Ø°Ø®ÛŒØ±Ù‡ -->
                    <button @click="toggleSave()" class="btn-action btn-save" :class="{ 'saved': isSaved }">
                        <i :class="isSaved ? 'fas fa-bookmark' : 'far fa-bookmark'"></i>
                        <span x-text="isSaved ? 'Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡' : 'Ø°Ø®ÛŒØ±Ù‡'"></span>
                    </button>

                    <!-- Ø¯Ú©Ù…Ù‡ Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ - hover: background Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© -->
                    <button @click="shareLink()" class="btn-action btn-share"
                        :class="prescription?.category?.color_code" style="background: white !important;">
                        <i class="fas fa-share-alt"></i>
                        <span>Ø§Ø´ØªØ±Ø§Ú©â€ŒÚ¯Ø°Ø§Ø±ÛŒ</span>
                    </button>

                    <!-- Ø¯Ú©Ù…Ù‡ Ø³ÙˆØ§Ù„ - hover: background Ø¯Ø§ÛŒÙ†Ø§Ù…ÛŒÚ© -->
                    <button @click="scrollToQuestion()" class="btn-action btn-question" id="question"
                        :class="prescription?.category?.color_code" style="background: white !important;">
                        <i class="fas fa-question-circle"></i>
                        <span>Ù¾Ø±Ø³Ø´ Ø³ÙˆØ§Ù„</span>
                    </button>

                </div>

            </div>
        </div>
<!-- Floating Question Button (Premium Feature) -->
<div class="fixed bottom-6 left-6 z-50" x-show="isPremiumUser">
    <button 
        @click="scrollToQuestion()"
        class="group bg-gradient-to-r from-amber-400 to-amber-600 text-white font-bold px-6 py-3 rounded-full shadow-lg hover:shadow-2xl hover:scale-105 transition-all duration-300 flex items-center gap-2"
    >
        <i class="fas fa-comment-medical text-lg"></i>
        <span class="hidden sm:inline">Ù¾Ø±Ø³Ø´ Ø³ÙˆØ§Ù„</span>
        <i class="fas fa-arrow-down text-sm group-hover:animate-bounce"></i>
    </button>
</div>

    </div>

    <!-- ========== WARNING BOX ========== -->
    <div class="mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <div class="warning-box rounded-2xl p-6 sm:p-8">
            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6">

                <!-- Ø¢ÛŒÚ©ÙˆÙ† Ù‡Ø´Ø¯Ø§Ø± -->
                <div
                    class="warning-icon flex-shrink-0 w-14 h-14 sm:w-16 sm:h-16 rounded-2xl flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-white text-2xl sm:text-3xl"></i>
                </div>

                <!-- Ù…ØªÙ† Ù‡Ø´Ø¯Ø§Ø± -->
                <div class="flex-1">
                    <h3 class="text-lg sm:text-xl font-black text-red-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-shield-alt text-red-600"></i>
                        <span>Ù‡Ø´Ø¯Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÛŒ Ùˆ Ú©Ù¾ÛŒâ€ŒØ±Ø§ÛŒØª</span>
                    </h3>

                    <div class="space-y-2 text-sm sm:text-base text-red-900 leading-relaxed">
                        <p class="font-bold">
                            <i class="fas fa-info-circle text-red-600 ml-1"></i>
                            Ù…Ø­ØªÙˆØ§ÛŒ Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø­Ø§ØµÙ„ Ø³Ø§Ø¹Øªâ€ŒÙ‡Ø§ ØªÙ„Ø§Ø´ Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ù…Ø®ØªÙ„Ù Ø§Ø³Øª.
                        </p>
                        <p class="font-semibold">
                            <i class="fas fa-ban text-red-600 ml-1"></i>
                            Ø§Ù†ØªØ´Ø§Ø± Ø§ÛŒÙ† Ù…Ø­ØªÙˆØ§ Ø´Ø±Ø¹Ø§Ù‹ Ø­Ø±Ø§Ù… Ùˆ Ø§Ø² Ù†Ø¸Ø± Ù‚Ø§Ù†ÙˆÙ†ÛŒ Ù‚Ø§Ø¨Ù„ Ù¾ÛŒÚ¯ÛŒØ±ÛŒ Ø®ÙˆØ§Ù‡Ø¯ Ø¨ÙˆØ¯.
                        </p>
                        <p class="font-medium text-red-700 mt-3 p-3 bg-red-50 rounded-lg border-r-4 border-red-500">
                            <i class="fas fa-gavel text-red-600 ml-1"></i>
                            Ù„Ø·ÙØ§Ù‹ Ø§Ø² Ø§Ù†ØªØ´Ø§Ø± Ù…Ø­ØªÙˆØ§ Ø¨Ù¾Ø±Ù‡ÛŒØ²ÛŒØ¯.
                        </p>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- ==================== DRUGS TABLE & DESCRIPTION SECTION ==================== -->
    <section x-show="!loading && prescription" class="container mx-auto px-4 py-8">
        <!-- Desktop: Two Column Layout | Mobile: Stacked -->
        <div class="flex flex-col lg:flex-row-reverse gap-6 ">

            <!-- ============ LEFT COLUMN: DESCRIPTION (20-30% on Desktop) ============ -->
            <template x-if="prescription?.description && description && description.trim() !== '' && description !== '<p>sdf</p>'" class="order-1 lg:order-2">
                <aside class="w-full lg:w-80 lg:flex-shrink-0 order-1 lg:order-2">
                    <!-- Sticky Container -->
                    <div class="lg:sticky lg:top-24">
                        <!-- Card Design -->
                        <div
                            class="bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                            <!-- Header -->
                            <div :class="prescription?.category?.color_code" class="px-5 py-4 text-white">
                                <h3 class="text-lg font-bold flex items-center gap-2">
                                    <i class="fas fa-file-medical-alt"></i>
                                    <span>ØªÙˆØ¶ÛŒØ­Ø§Øª Ù†Ø³Ø®Ù‡</span>
                                </h3>
                            </div>

                            <!-- Description Content -->
                            <div class="p-5">
                                <!-- Loading State -->
                                <template x-if="descriptionLoading">
                                    <div class="flex items-center justify-center py-8">
                                        <div class="flex flex-col items-center gap-3">
                                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-c1"></div>
                                            <p class="text-sm text-gray-500">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</p>
                                        </div>
                                    </div>
                                </template>

                                <!-- Description Text (HTML Content) -->
                                <template x-if="!descriptionLoading">
                                    <div>
                                        <!-- Check if description has content -->
                                        <template
                                            x-if="description && description.trim() !== '' && description !== '<p></p>'" >
                                            <div class="prose prose-sm max-w-none text-gray-700 leading-relaxed"
                                                x-html="description"></div>
                                        </template>
                                    </div>
                                </template>

                            </div>

                            <!-- Footer: Icon Decoration -->
                            <div class="px-5 py-3 bg-gray-50 border-t border-gray-100">
                                <p class="text-xs text-gray-500 flex items-center gap-2">
                                    <i class="fas fa-lightbulb text-amber-500"></i>
                                    <span>Ø§ÛŒÙ† ØªÙˆØ¶ÛŒØ­Ø§Øª ØªÙˆØ³Ø· Ù…ØªØ®ØµØµÛŒÙ† ØªÙ‡ÛŒÙ‡ Ø´Ø¯Ù‡ Ø§Ø³Øª</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </aside>
            </template>

            <!-- ============ RIGHT COLUMN: DRUGS TABLE (70-80% on Desktop) ============ -->
            <div class="w-full lg:flex-1 order-2 lg:order-1">
                <!-- Section Title -->
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-2 flex items-center gap-3">
                        <i class="fas fa-pills text-c1"></i>
                        <span>Ù„ÛŒØ³Øª Ø¯Ø§Ø±ÙˆÙ‡Ø§</span>
                    </h2>
                    <p class="text-sm text-gray-600">
                        Ø¬Ø¯ÙˆÙ„ Ø²ÛŒØ± Ø´Ø§Ù…Ù„ ØªÙ…Ø§Ù…ÛŒ Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ ØªØ¬ÙˆÛŒØ² Ø´Ø¯Ù‡ Ø§Ø³Øª. Ù„Ø·ÙØ§Ù‹ Ø¨Ù‡ Ø¯Ù‚Øª Ù…Ø·Ø§Ù„Ø¹Ù‡ Ú©Ù†ÛŒØ¯.
                    </p>
                </div>

                <!-- Table Wrapper: Horizontal Scroll on Mobile -->
                <div class="w-full overflow-x-auto rounded-lg border border-gray-200 shadow-sm">
                    <table class="w-full min-w-[800px] border-collapse">
                        <!-- Table Header: Dynamic Background Color -->
                        <thead>
                            <tr :class="prescription?.category?.color_code" class="text-white">
                                <th class="px-4 py-3 text-right text-sm font-semibold border-b-2 border-white/20">
                                    Ø±Ø¯ÛŒÙ
                                </th>
                                <th class="px-4 py-3 text-right text-sm font-semibold border-b-2 border-white/20">
                                    Ù†Ø§Ù… Ø¯Ø§Ø±Ùˆ
                                </th>
                                <th class="px-4 py-3 text-right text-sm font-semibold border-b-2 border-white/20">
                                    Ú©Ø¯ Ø¯Ø§Ø±Ùˆ
                                </th>
                                <th class="px-4 py-3 text-right text-sm font-semibold border-b-2 border-white/20">
                                    Ø¯ÙˆØ² Ù…ØµØ±Ù
                                </th>
                                <th class="px-4 py-3 text-right text-sm font-semibold border-b-2 border-white/20">
                                    ØªØ¹Ø¯Ø§Ø¯
                                </th>
                                <th class="px-4 py-3 text-right text-sm font-semibold border-b-2 border-white/20">
                                    ØªÙˆØ¶ÛŒØ­Ø§Øª
                                </th>
                            </tr>
                        </thead>

                        <!-- Table Body -->
                        <tbody class="bg-white divide-y divide-gray-200">
                            <template x-for="(drug, index) in prescription?.prescription_drugs" :key="drug.drug.code">
                                <tr class="hover:bg-gray-50 transition-colors relative" :class="{
                            'border-r-4': drug.is_combination,
                            'bg-blue-50/30': drug.is_combination
                        }" :style="drug.is_combination ? `border-right-color: ${getBgColorStyle(prescription?.category?.color_code)}` : ''">

                                    <!-- Column 1: Row Number -->
                                    <td class="px-4 py-4 text-sm text-gray-700 border-l border-gray-200">
                                        <div class="flex items-center gap-2">
                                            <!-- Row Number -->
                                            <span class="font-medium" x-text="index + 1"></span>

                                            <!-- Icon: Combination Link (Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Badge Ø§Ø¶Ø§ÙÛŒ) -->
                                            <template x-if="drug.is_combination">
                                                <div class="flex items-center gap-1">
                                                    <i class="fas fa-link text-sm"
                                                        :style="`color: ${getBgColorStyle(prescription?.category?.color_code)}`"
                                                        title="Ø¯Ø§Ø±Ùˆ ØªØ±Ú©ÛŒØ¨ÛŒ"></i>
                                                    <span class="text-xs font-bold"
                                                        :style="`color: ${getBgColorStyle(prescription?.category?.color_code)}`"
                                                        x-text="drug.group_number"></span>
                                                </div>
                                            </template>

                                            <!-- Badge: Combination Group (Ù‡Ù…ÙˆÙ† Badge Ù‚Ø¨Ù„ÛŒ) -->
                                            <template x-if="drug.is_combination">
                                                <span :class="prescription?.category?.color_code"
                                                    class="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white">
                                                    <i class="fas fa-layer-group text-[10px]"></i>
                                                    <span>ØªØ±Ú©ÛŒØ¨ÛŒ</span>
                                                    <span x-show="drug.group_number" x-text="drug.group_number"></span>
                                                </span>
                                            </template>

                                            <!-- Badge: Substitute Drug -->
                                            <template x-if="drug.is_substitute">
                                                <span :class="prescription?.category?.color_code"
                                                    class="inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium text-white">
                                                    <i class="fas fa-exchange-alt text-[10px]"></i>
                                                    <span>Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†</span>
                                                </span>
                                            </template>
                                        </div>
                                    </td>

                                    <!-- Column 2: Drug Name -->
                                    <td class="px-4 py-4 text-sm text-gray-900 font-medium border-l border-gray-200">
                                        <span x-text="drug.drug.title"></span>
                                    </td>

                                    <!-- Column 3: Drug Code (5 chars + Copy Button) -->
                                    <td class="px-4 py-4 text-sm border-l border-gray-200"
                                        :class="drug.is_substitute ? prescription?.category?.color_code : 'bg-transparent'">
                                        <div class="flex items-center gap-2">
                                            <!-- Display: First 5 Characters -->
                                            <span class="font-mono font-semibold"
                                                :class="drug.is_substitute ? 'text-white' : 'text-gray-800'"
                                                x-text="drug.drug.code.substring(0, 5)"></span>

                                            <!-- Copy Button -->
                                            <button @click="copyDrugCode(drug.drug.code)"
                                                class="p-1.5 rounded hover:bg-gray-100 transition-colors group"
                                                :class="drug.is_substitute ? 'hover:bg-white/20' : ''"
                                                title="Ú©Ù¾ÛŒ Ú©Ø¯ Ú©Ø§Ù…Ù„">
                                                <i class="fas fa-copy text-xs"
                                                    :class="drug.is_substitute ? 'text-white group-hover:text-white' : 'text-gray-500 group-hover:text-gray-700'"></i>
                                            </button>
                                        </div>
                                    </td>

                                    <!-- Column 4: Dosage -->
                                    <td class="px-4 py-4 text-sm text-gray-700 border-l border-gray-200">
                                        <span x-text="drug.dosage || 'â€”'"></span>
                                    </td>

                                    <!-- Column 5: Amount -->
                                    <td class="px-4 py-4 text-sm text-gray-700 font-medium border-l border-gray-200">
                                        <span x-text="drug.amount"></span>
                                    </td>

                                    <!-- Column 6: Instructions (Truncated with "More" Button) -->
                                    <td class="px-4 py-4 text-sm text-gray-700">
                                        <div class="flex items-start gap-2">
                                            <!-- Truncated Text (1 line) -->
                                            <p class="line-clamp-1 flex-1" x-text="drug.instructions || 'â€”'"></p>

                                            <!-- "More" Button: Show if text > 100 chars -->
                                            <template x-if="drug.instructions && drug.instructions.length > 100">
                                                <button @click="showFullDescription(drug.instructions)"
                                                    class="flex-shrink-0 text-c1 hover:text-c2 font-medium text-xs whitespace-nowrap">
                                                    Ø¨ÛŒØ´ØªØ±
                                                    <i class="fas fa-chevron-left mr-1 text-[10px]"></i>
                                                </button>
                                            </template>
                                        </div>
                                    </td>

                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>

                <!-- Info Box: Combination Drugs Explanation -->
                <template x-if="prescription?.prescription_drugs?.some(d => d.is_combination)">
                    <div class="mt-4 p-4 bg-blue-50 border-r-4 border-blue-500 rounded-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-500 mt-0.5"></i>
                            <div class="text-sm text-gray-700">
                                <p class="font-semibold text-gray-900 mb-1">Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ ØªØ±Ú©ÛŒØ¨ÛŒ:</p>
                                <p>Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ Ø¨Ø§ Ù†Ø´Ø§Ù† "ØªØ±Ú©ÛŒØ¨ÛŒ" Ø¨Ø§ÛŒØ¯ Ø¨Ø§ Ù‡Ù… Ùˆ Ø·Ø¨Ù‚ Ø¯Ø³ØªÙˆØ± Ù¾Ø²Ø´Ú© Ù…ØµØ±Ù Ø´ÙˆÙ†Ø¯. Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ ÛŒÚ© Ú¯Ø±ÙˆÙ‡ Ø¨Ø§
                                    Ø±Ù†Ú¯ ÛŒÚ©Ø³Ø§Ù† Ù…Ø´Ø®Øµ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.</p>
                            </div>
                        </div>
                    </div>
                </template>

                <!-- Info Box: Substitute Drugs Explanation -->
                <template x-if="prescription?.prescription_drugs?.some(d => d.is_substitute)">
                    <div class="mt-4 p-4 bg-amber-50 border-r-4 border-amber-500 rounded-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exchange-alt text-amber-500 mt-0.5"></i>
                            <div class="text-sm text-gray-700">
                                <p class="font-semibold text-gray-900 mb-1">Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†:</p>
                                <p>Ø¯Ø§Ø±ÙˆÙ‡Ø§ÛŒ Ø¨Ø§ Ù†Ø´Ø§Ù† "Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ†" Ùˆ Ú©Ø¯ Ø¯Ø§Ø±Ùˆ Ø±Ù†Ú¯ÛŒØŒ Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù‡Ø³ØªÙ†Ø¯. Ø§Ø² Ø¨ÛŒÙ† Ø¢Ù†Ù‡Ø§ ÛŒÚ©ÛŒ Ø±Ø§
                                    Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</p>
                            </div>
                        </div>
                    </div>
                </template>

            </div>



        </div>
    </section>

    <!-- ==================== IMAGE BOX SECTION ==================== -->
    <div x-show="prescription.images && prescription.images.length > 0" 
    class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 mx-6">
   <!-- Header -->
   <div class="flex items-center gap-3 mb-5 pb-4 border-b border-gray-100">
       <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-c1 to-c2 flex items-center justify-center">
           <i class="fas fa-images text-white text-lg"></i>
       </div>
       <h3 class="text-lg font-bold text-gray-800">ØªØµØ§ÙˆÛŒØ± Ù¾ÛŒÙˆØ³Øª</h3>
       <span class="mr-auto text-sm text-gray-500 bg-gray-50 px-3 py-1 rounded-full" 
             x-text="prescription.images.length + ' ØªØµÙˆÛŒØ±'"></span>
   </div>

   <!-- Images Grid -->
   <div class="grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3">
       <template x-for="(image, index) in prescription.images" :key="index">
           <a :href="image.image" 
              class="glightbox group relative aspect-square rounded-xl overflow-hidden bg-gray-100 cursor-pointer transition-all duration-300 hover:shadow-lg hover:scale-105"
              :data-gallery="'prescription-gallery'"
              :data-description="image.caption || ''">
               <!-- Image -->
               <img :src="image.image" 
                    :alt="image.caption || 'ØªØµÙˆÛŒØ± Ù†Ø³Ø®Ù‡'"
                    class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                    loading="lazy">
               
               <!-- Overlay -->
               <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/0 to-black/0 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                   <div class="absolute bottom-2 left-2 right-2 flex items-center justify-center">
                       <div class="bg-white/90 backdrop-blur-sm rounded-lg px-3 py-1.5 flex items-center gap-2">
                           <i class="fas fa-search-plus text-c1 text-sm"></i>
                           <span class="text-xs font-semibold text-gray-700">Ù…Ø´Ø§Ù‡Ø¯Ù‡</span>
                       </div>
                   </div>
               </div>

               <!-- Badge -->
               <div class="absolute top-2 right-2 bg-white/90 backdrop-blur-sm rounded-lg px-2 py-1 text-xs font-bold text-gray-600">
                   <span x-text="index + 1"></span>
               </div>
           </a>
       </template>
   </div>
</div>

    <!-- ==================== VIDEO BOX SECTION ==================== -->
    <div x-show="prescription.videos && prescription.videos.length > 0" 
    class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 mx-6">
   <!-- Header -->
   <div class="flex items-center gap-3 mb-5 pb-4 border-b border-gray-100">
       <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-c3 to-c4 flex items-center justify-center">
           <i class="fas fa-video text-white text-lg"></i>
       </div>
       <h3 class="text-lg font-bold text-gray-800">ÙˆÛŒØ¯ÛŒÙˆÙ‡Ø§ÛŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ</h3>
       <span class="mr-auto text-sm text-gray-500 bg-gray-50 px-3 py-1 rounded-full" 
             x-text="prescription.videos.length + ' ÙˆÛŒØ¯ÛŒÙˆ'"></span>
   </div>

   <!-- Videos Grid -->
   <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
       <template x-for="(video, index) in prescription.videos" :key="index">
           <a :href="video.video_url" 
              target="_blank"
              rel="noopener noreferrer"
              class="group relative bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 border border-gray-200 hover:border-c2 hover:shadow-md transition-all duration-300">
               
               <!-- Icon Container -->
               <div class="flex items-start gap-3 mb-3">
                   <div class="flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-c1 to-c2 flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                       <i class="fas fa-play text-white text-lg"></i>
                   </div>
                   
                   <!-- Title -->
                   <div class="flex-1 min-w-0">
                       <h4 class="text-sm font-bold text-gray-800 line-clamp-2 mb-1 group-hover:text-c1 transition-colors" 
                           x-text="video.title || 'ÙˆÛŒØ¯ÛŒÙˆ Ù¾ÛŒÙˆØ³Øª Ø´Ø¯Ù‡'"></h4>
                       <div class="flex items-center gap-1 text-xs text-gray-500">
                           <i class="fas fa-external-link-alt"></i>
                           <span>Ø¢Ù¾Ø§Ø±Ø§Øª</span>
                       </div>
                   </div>
               </div>

               <!-- Watch Button -->
               <div class="flex items-center justify-between pt-3 border-t border-gray-200">
                   <span class="text-xs font-semibold text-c1 group-hover:text-c2 transition-colors">
                       Ù…Ø´Ø§Ù‡Ø¯Ù‡ ÙˆÛŒØ¯ÛŒÙˆ
                   </span>
                   <i class="fas fa-arrow-left text-c1 group-hover:translate-x-[-4px] transition-transform duration-300"></i>
               </div>

               <!-- Badge -->
               <div class="absolute top-2 left-2 bg-white rounded-lg px-2 py-1 text-xs font-bold text-gray-600 shadow-sm">
                   <span x-text="index + 1"></span>
               </div>
           </a>
       </template>
   </div>
</div>

<!-- Question Section (Premium Feature) -->
<div id="question-section" 
     class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6 mx-6"
     x-data="{ isPremium: false }"
     x-init="isPremium = checkPremiumStatus()">
    
    <!-- Header -->
    <div class="flex items-center gap-3 mb-5 pb-4 border-b border-gray-100">
        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center">
            <i class="fas fa-crown text-white text-lg"></i>
        </div>
        <div class="flex-1">
            <h3 class="text-lg font-bold text-gray-800">Ù¾Ø±Ø³Ø´ Ø§Ø² Ù…ØªØ®ØµØµ</h3>
            <p class="text-xs text-gray-500 mt-1">Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ø² Ù¾Ø²Ø´Ú© Ù…ØªØ®ØµØµ Ø¨Ù¾Ø±Ø³ÛŒØ¯</p>
        </div>
        <span class="bg-gradient-to-r from-amber-100 to-amber-200 text-amber-700 text-xs font-bold px-3 py-1.5 rounded-full flex items-center gap-1">
            <i class="fas fa-star text-amber-500"></i>
            ÙˆÛŒÚ˜Ù‡ Premium
        </span>
    </div>

    <!-- Premium User Form -->
    <template x-if="isPremium">
        <div>
            <!-- Textarea -->
            <div class="mb-4">
                <label class="block text-sm font-semibold text-gray-700 mb-2">
                    <i class="fas fa-comment-medical text-c1 ml-1"></i>
                    Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯:
                </label>
                <textarea 
                    x-model="questionText"
                    rows="4"
                    placeholder="Ø³ÙˆØ§Ù„ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."
                    class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-c2 focus:ring-2 focus:ring-c3/20 transition-all resize-none"
                    :disabled="questionSubmitting"
                ></textarea>
                <div class="flex items-center justify-between mt-2">
                    <p class="text-xs text-gray-500">
                        <i class="fas fa-info-circle ml-1"></i>
                        Ù¾Ø§Ø³Ø® Ø§Ø² Ø·Ø±ÛŒÙ‚ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø´Ù…Ø§ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
                    </p>
                    <span class="text-xs text-gray-400" x-text="(questionText || '').length + ' / 500'"></span>
                </div>
            </div>

            <!-- Submit Button -->
            <button 
                @click="submitQuestion()"
                :disabled="questionSubmitting || !questionText.trim() || questionText.length > 500"
                class="w-full bg-gradient-to-r from-c1 to-c2 text-white font-bold py-3 rounded-xl hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center gap-2"
            >
                <template x-if="!questionSubmitting">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-paper-plane"></i>
                        <span>Ø§Ø±Ø³Ø§Ù„ Ø³ÙˆØ§Ù„</span>
                    </div>
                </template>
                <template x-if="questionSubmitting">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...</span>
                    </div>
                </template>
            </button>

            <!-- Info Box -->
            <div class="mt-4 bg-blue-50 border-r-4 border-c1 rounded-lg p-4">
                <div class="flex gap-3">
                    <i class="fas fa-lightbulb text-c1 text-xl flex-shrink-0"></i>
                    <div class="text-sm text-gray-700">
                        <p class="font-semibold mb-1">Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…:</p>
                        <ul class="space-y-1 text-xs">
                            <li>â€¢ Ù¾Ø§Ø³Ø® Ø´Ù…Ø§ Ø­Ø¯Ø§Ú©Ø«Ø± Ø¸Ø±Ù 24 Ø³Ø§Ø¹Øª Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
                            <li>â€¢ Ø³ÙˆØ§Ù„Ø§Øª ÙÙ‚Ø· Ù…Ø±ØªØ¨Ø· Ø¨Ø§ Ø§ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø¨Ø§Ø´Ø¯</li>
                            <li>â€¢ Ù¾Ø§Ø³Ø® Ø¯Ø± Ø¨Ø®Ø´ "Ù¾Ø±ÙˆÙØ§ÛŒÙ„ > Ø³ÙˆØ§Ù„Ø§Øª Ù…Ù†" Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø§Ø³Øª</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Non-Premium User Message -->
    <template x-if="!isPremium">
        <div class="text-center py-8">
            <!-- Icon -->
            <div class="w-20 h-20 bg-gradient-to-br from-amber-100 to-amber-200 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-lock text-amber-600 text-3xl"></i>
            </div>

            <!-- Message -->
            <h4 class="text-xl font-bold text-gray-800 mb-2">Ø§ÛŒÙ† Ù‚Ø§Ø¨Ù„ÛŒØª ÙˆÛŒÚ˜Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Premium Ø§Ø³Øª</h4>
            <p class="text-gray-600 mb-6 max-w-md mx-auto">
                Ø¨Ø§ Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© ÙˆÛŒÚ˜Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ù¾Ø²Ø´Ú©Ø§Ù† Ù…ØªØ®ØµØµ Ø³ÙˆØ§Ù„ Ø¨Ù¾Ø±Ø³ÛŒØ¯ Ùˆ Ù¾Ø§Ø³Ø® ØªØ®ØµØµÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯
            </p>

            <!-- Features List -->
            <div class="bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl p-6 mb-6 max-w-lg mx-auto">
                <p class="font-bold text-gray-800 mb-3 flex items-center justify-center gap-2">
                    <i class="fas fa-gift text-amber-500"></i>
                    Ù…Ø²Ø§ÛŒØ§ÛŒ Ø§Ø´ØªØ±Ø§Ú© Premium:
                </p>
                <ul class="space-y-2 text-sm text-gray-700 text-right">
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-green-500 mt-0.5 flex-shrink-0"></i>
                        <span>Ù¾Ø±Ø³Ø´ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯ Ø§Ø² Ù¾Ø²Ø´Ú©Ø§Ù† Ù…ØªØ®ØµØµ</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-green-500 mt-0.5 flex-shrink-0"></i>
                        <span>Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ù‡Ù…Ù‡ Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ Ùˆ Ø¯Ø§Ø±ÙˆÙ‡Ø§</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-green-500 mt-0.5 flex-shrink-0"></i>
                        <span>Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ 24/7</span>
                    </li>
                    <li class="flex items-start gap-2">
                        <i class="fas fa-check text-green-500 mt-0.5 flex-shrink-0"></i>
                        <span>Ø¢Ù¾Ø¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ Ùˆ Ù…Ø­ØªÙˆØ§ÛŒ ÙˆÛŒÚ˜Ù‡</span>
                    </li>
                </ul>
            </div>

            <!-- CTA Button -->
            <button 
                @click="window.location.href = '/plans'"
                class="bg-gradient-to-r from-amber-400 to-amber-600 text-white font-bold px-8 py-3 rounded-xl hover:shadow-xl hover:scale-105 transition-all duration-300 inline-flex items-center gap-2"
            >
                <i class="fas fa-crown"></i>
                <span>Ø®Ø±ÛŒØ¯ Ø§Ø´ØªØ±Ø§Ú© Premium</span>
                <i class="fas fa-arrow-left"></i>
            </button>
        </div>
    </template>
</div>




    <!-- ==================== MODAL: FULL DESCRIPTION ==================== -->
    <template x-if="showDescriptionModal">
        <div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"
            @click.self="showDescriptionModal = false" x-transition:enter="transition ease-out duration-300"
            x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
            x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0">
            <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden" @click.stop
                x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 scale-95"
                x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-200"
                x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-95">
                <!-- Modal Header -->
                <div :class="prescription?.category?.color_code"
                    class="px-6 py-4 text-white flex items-center justify-between">
                    <h3 class="text-lg font-bold flex items-center gap-2">
                        <i class="fas fa-align-right"></i>
                        <span>ØªÙˆØ¶ÛŒØ­Ø§Øª Ú©Ø§Ù…Ù„</span>
                    </h3>
                    <button @click="showDescriptionModal = false"
                        class="p-2 hover:bg-white/20 rounded-lg transition-colors">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>

                <!-- Modal Body: Scrollable -->
                <div class="p-6 overflow-y-auto max-h-[calc(80vh-80px)]">
                    <p class="text-gray-700 leading-relaxed whitespace-pre-wrap" x-text="fullDescription"></p>
                </div>
            </div>
        </div>
    </template>

    
</div>


<script src="{% static 'js/prescription_detail.js' %}"></script>
{% endblock %}